CREATE TABLE SAILORS(sid INT,sname VARCHAR(10),rating INT,age INT);
INSERT INTO SAILORS(sid,sname,rating,age) VALUES(22,'Dustin',7,45),
(29,'Brutas',1,33),
(31,'Lubber',8,55),
(32,'Andy',8,25),
(58,'Rusty',10,35),
(64,'Horatio',7,35),
(71,'Zorba',10,16),
(74,'Horatio',9,35),
(85,'Art',3,26),
(95,'Bob',3,64);
SELECT * FROM SAILORS;
CREATE TABLE BOATS(bid INT,bname VARCHAR(50),color VARCHAR(50));
DESCRIBE BOATS;
INSERT INTO BOATS(bid,bname,color) VALUES(101,'Interlake','Blue'), 
(102,'Interlake','Red'),
(103,'Clipper','Green'),
(104,'Marine','Red'); 
SELECT * FROM BOATS;
CREATE TABLE RESERVES(sid INT,bid INT,day DATE);
DESCRIBE RESERVES;
INSERT INTO RESERVES(sid,bid,day) VALUES(22,101,'98-10-10'),
(22,102,'98-10-10'),
(22,103,'98-8-10'),
(22,104,'98-7-10'),
(31,102,'98-10-11'),
(31,103,'98-6-11'),
(31,104,'98-12-11'),
(64,101,'98-5-9'),
(64,102,'98-8-9'),
(74,103,'98-8-9');
SELECT * FROM RESERVES;
SELECT sname,age FROM SAILORS;
SELECT * FROM SAILORS,RESERVES WHERE SAILORS.sid=RESERVES.sid AND bid=101;
SELECT sname  FROM SAILORS WHERE rating>7;
SELECT sname FROM SAILORS,RESERVES WHERE SAILORS.sid=RESERVES.sid AND bid=103; 
SELECT DISTINCT sname FROM SAILORS,BOATS,RESERVES WHERE color='red'AND SAILORS.sid=RESERVES.sid AND BOATS.bid=RESERVES.bid ORDER BY age;
SELECT DISTINCT sname FROM SAILORS,RESERVES,BOATS WHERE (color='red' or color='green') AND BOATS.bid=RESERVES.bid AND SAILORS.sid=RESERVES.sid; 
SELECT DISTINCT color FROM SAILORS,BOATS,RESERVES WHERE sname='Lubber' AND SAILORS.sid=RESERVES.sid AND BOATS.bid=RESERVES.bid;
SELECT DISTINCT sname FROM SAILORS,BOATS,RESERVES WHERE color='red' And SAILORS.sid=RESERVES.sid AND BOATS.bid=RESERVES.bid UNION SELECT DISTINCT sname FROM SAILORS,BOATS,RESERVES WHERE color='green' And SAILORS.sid=RESERVES.sid AND BOATS.bid=RESERVES.bid;
SELECT DISTINCT sname FROM SAILORS,RESERVES WHERE SAILORS.sid=RESERVES.sid;
SELECT sname,reserves.sid FROM RESERVES,SAILORS WHERE sailors.sid = reserves.sid GROUP BY DAY,reserves.sid,sname HAVING COUNT(DAY)>1 ;
SELECT sname,age FROM SAILORS WHERE age =(SELECT MIN(age) FROM sailors) ;
SELECT sname FROM SAILORS WHERE rating > (SELECT MAX(rating) FROM SAILORS WHERE sname = 'Horatio');
SELECT sname,sid FROM (SELECT sname,reserves.sid,COUNT(bid) AS id FROM RESERVES,SAILORS WHERE reserves.sid = sailors.sid GROUP BY reserves.SID,sname) a WHERE id =( SELECT COUNT(bid) FROM BOATS);
SELECT COUNT(c.sname) FROM (SELECT DISTINCT sname FROM Sailors) c;
SELECT AVG(age) FROM SAILORS;
SELECT rating,AVG(age) FROM SAILORS GROUP BY rating;
SELECT a.rating,b.mean FROM (SELECT COUNT(sname) AS num,rating FROM SAILORS GROUP BY rating HAVING COUNT(sname)>1) a, (SELECT rating,AVG(age) AS mean FROM SAILORS GROUP BY rating ) b WHERE a.rating = b.rating;
